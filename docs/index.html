<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yufei Wu">

<title>Macroeconometrics Research Report - Effects of Monetary Policy Shocks on Exchange Rate: Evidence from Australia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Macroeconometrics Research Report</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#preliminary-data-analysis" id="toc-preliminary-data-analysis" class="nav-link" data-scroll-target="#preliminary-data-analysis">Preliminary Data Analysis</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology"><strong>Methodology</strong></a>
  <ul class="collapse">
  <li><a href="#sign-restriction-identification" id="toc-sign-restriction-identification" class="nav-link" data-scroll-target="#sign-restriction-identification"><strong>Sign Restriction Identification</strong></a></li>
  </ul></li>
  <li><a href="#estimation-framework" id="toc-estimation-framework" class="nav-link" data-scroll-target="#estimation-framework">Estimation Framework</a>
  <ul class="collapse">
  <li><a href="#model-specification" id="toc-model-specification" class="nav-link" data-scroll-target="#model-specification"><strong>Model specification</strong></a></li>
  </ul></li>
  <li><a href="#baseline-model" id="toc-baseline-model" class="nav-link" data-scroll-target="#baseline-model"><strong>Baseline Model</strong></a>
  <ul class="collapse">
  <li><a href="#estimation-procedure" id="toc-estimation-procedure" class="nav-link" data-scroll-target="#estimation-procedure"><strong>Estimation Procedure</strong></a></li>
  <li><a href="#estimation-algorithm" id="toc-estimation-algorithm" class="nav-link" data-scroll-target="#estimation-algorithm"><strong>Estimation Algorithm</strong></a></li>
  <li><a href="#simulation-result" id="toc-simulation-result" class="nav-link" data-scroll-target="#simulation-result"><strong>Simulation Result</strong></a></li>
  </ul></li>
  <li><a href="#extension-model-with-gamma-distribution" id="toc-extension-model-with-gamma-distribution" class="nav-link" data-scroll-target="#extension-model-with-gamma-distribution"><strong>Extension Model With Gamma Distribution</strong></a>
  <ul class="collapse">
  <li><a href="#estimation-algorithm-1" id="toc-estimation-algorithm-1" class="nav-link" data-scroll-target="#estimation-algorithm-1"><strong>Estimation Algorithm</strong></a></li>
  <li><a href="#simulation-result-1" id="toc-simulation-result-1" class="nav-link" data-scroll-target="#simulation-result-1"><strong>Simulation Result</strong></a></li>
  </ul></li>
  <li><a href="#empirical-estimation-results" id="toc-empirical-estimation-results" class="nav-link" data-scroll-target="#empirical-estimation-results">Empirical Estimation Results</a></li>
  <li><a href="#baseline-model-1" id="toc-baseline-model-1" class="nav-link" data-scroll-target="#baseline-model-1"><strong>Baseline Model</strong></a></li>
  <li><a href="#extension-model-with-gamma-distribution-1" id="toc-extension-model-with-gamma-distribution-1" class="nav-link" data-scroll-target="#extension-model-with-gamma-distribution-1"><strong>Extension Model With Gamma Distribution</strong></a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Effects of Monetary Policy Shocks on Exchange Rate: Evidence from Australia</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yufei Wu </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p><strong>Abstract.</strong> This research proposal aim to examine the exchange rate reactions to monetary policy shocks in Australia from 1980 to 2024 using the Bayesian Structural Vector Auto-regression (SVAR) model.</p>
<p><strong>Keywords.</strong> R, Monetary policy, exchange rate, SVAR model</p>
</blockquote>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>How monetary policy shocks affect exchange rate? The most well-known study from <span class="citation" data-cites="dornbusch1976">Dornbusch (<a href="#ref-dornbusch1976" role="doc-biblioref">1976</a>)</span> documented the overshooting model, which predicts that the monetary expansion would lead to an increase in domestic interest rate and persistence depreciation of exchange rate. However, more economists such as <span class="citation" data-cites="eichenbaum1995">Eichenbaum and Evans (<a href="#ref-eichenbaum1995" role="doc-biblioref">1995</a>)</span> utilized VAR model found that contractionary monetary policy shocks lead to an appreciation in exchange rate, but might be delayed.</p>
<p>The recent study <span class="citation" data-cites="kim2018">Kim and Lim (<a href="#ref-kim2018" role="doc-biblioref">2018</a>)</span> further explored that relatively short delay in the effect of contractionary monetary shock to exchange rate appreciation for the UK, Australia, Sweden and Canada.</p>
<p>This paper aims to focus on investigate the effect of monetary shock in a small open economy Australia, applying the Bayesian Structural Vector Auto-regression (SVAR) model. What is the role of monetary policy shock in exchange rate behavior in Australia? Are the effect similar to those large countries? Do we find similar puzzling responses?</p>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<p>The endogenous variables for the SVAR analysis included:</p>
<ul>
<li><p><strong>Exchange rate of AUD/USD (ERA):</strong> nominal average exchange rate AUD/USD (from RBA)</p></li>
<li><p><strong>Monetary base M1 (MB):</strong> Monetary base, seasonally adjusted (M1) (from RBA)</p></li>
<li><p><strong>Short–term interest rate (Short_R) :</strong> Cash rate target (from RBA)</p></li>
<li><p><strong>Gross Domestic Product (GDP):</strong> Real GDP (quarterly) Gross domestic product, Chain volume measures (from RBA)</p></li>
<li><p><strong>Consumer Price Index(CPI):</strong> Consumer price index, seasonally adjusted quarterly (from ABS)</p></li>
</ul>
<p>The data are collected from the Reserve Bank of Australia (RBA) and Australian Bureau of Statistics (ABS), adjusted in quarterly frequency and from 1990 Q1 to 2023 Q4, including 136 observations.</p>
<p>The first variable is the key variable in the analysis of the research, and the other 4 variables are the key monetary variables to identify the monetary shocks in Australia. All variables data have taken Logarithm except short-term interest rate and plotted in <a href="#figure-1-time-series-plots">Figure 1: Time-series plots</a>.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="figure-1-time-series-plots" class="level6">
<h6 class="anchored" data-anchor-id="figure-1-time-series-plots">Figure 1: Time-series plots</h6>
<p>Exchange rate changes are volatile overtime, exhibits peaks and troughs. Monetary base, GDP and CPI all illustrate increasing trend overtime, with some drops during the global financial crisis and during COVID-19 period. Short-term interest rate displays a downward trend since 2000. All time-series plots are restricted in the time period from 1980 Q1 to 2022 Q4.</p>
<p><a href="#table-1-summary-statistics">Table 1: Summary Statistics</a> provides statistics summary of all variables from 1980 Q1 to 2022 Q4.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Summary Statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;">variable</th>
<th style="text-align: right;">N</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ERA</td>
<td style="text-align: right;">172</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">1.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">MB</td>
<td style="text-align: right;">172</td>
<td style="text-align: right;">5.64</td>
<td style="text-align: right;">1.08</td>
<td style="text-align: right;">3.71</td>
<td style="text-align: right;">7.43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Short_R</td>
<td style="text-align: right;">172</td>
<td style="text-align: right;">4.59</td>
<td style="text-align: right;">2.86</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">16.75</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP</td>
<td style="text-align: right;">172</td>
<td style="text-align: right;">9.82</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">9.49</td>
<td style="text-align: right;">10.04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPI</td>
<td style="text-align: right;">172</td>
<td style="text-align: right;">4.46</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">4.03</td>
<td style="text-align: right;">4.91</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="table-1-summary-statistics" class="level6">
<h6 class="anchored" data-anchor-id="table-1-summary-statistics">Table 1: Summary statistics</h6>
</section>
<section id="preliminary-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="preliminary-data-analysis">Preliminary Data Analysis</h2>
<p><a href="#figure-2-acf-plots">Figure 2: ACF plots</a> shows that for GDP and CPI have non-zero auto correlations for at least 10 lags, for the ERA, MB, Short_R have non-zero auto correlations for at least 10 lags (shown in 2.5 years).This implies that all series are not white noise and may be non- stationary.We can take a first difference to remove the autocorrelation and ensure stationary for the series and check using ADF test.</p>
<p><a href="#figure-3-pacf-plots">Figure 3: PACF plots</a> shows no statistically significant lags except short-term interest rate. Short-term interest rate has some spikes in 4th lag and 5th lag, but not strong.This may suggest that except short-term interest rate, other series are stationary in order 1.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="figure-2-acf-plots" class="level6">
<h6 class="anchored" data-anchor-id="figure-2-acf-plots">Figure 2: ACF plots</h6>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="figure-3-pacf-plots" class="level6">
<h6 class="anchored" data-anchor-id="figure-3-pacf-plots">Figure 3: PACF plots</h6>
<p>Augmented Dickey-Fuller Test is performed to test for stationarity, the null hypothesis is unit-root non-stationary.A p-value less than 5% implies the null hypothesis is rejected.</p>
<p><a href="#table-2-adf-test">Table 2: ADF test</a> shows that for ERA, MB, GDP, we can not reject the null hypothesis at 5% significant level and considered as unit-root non-stationary. Short-term interest rate and CPI can reject the null at 5% significant level and considered as unit-root stationary.</p>
<p><a href="#table-3-adf-test-of-first-difference">Table 3: ADF test of First Difference</a> shows the first difference of all variables, ERA, MB, GDP can reject the null at 5% significant level and considered as unit-root stationary at first difference condition, they are integrated of order 1.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>ADF test</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Dickey-Fuller</th>
<th style="text-align: right;">Lag order</th>
<th style="text-align: right;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ERA</td>
<td style="text-align: right;">-1.98</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.58</td>
</tr>
<tr class="even">
<td style="text-align: left;">MB</td>
<td style="text-align: right;">-3.13</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Short_R</td>
<td style="text-align: right;">-3.77</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP</td>
<td style="text-align: right;">-1.36</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPI</td>
<td style="text-align: right;">-3.11</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.12</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="table-2-adf-test" class="level6">
<h6 class="anchored" data-anchor-id="table-2-adf-test">Table 2: ADF test</h6>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>ADF test of First Difference</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Dickey-Fuller</th>
<th style="text-align: right;">Lag order</th>
<th style="text-align: right;">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ERA</td>
<td style="text-align: right;">-4.56</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">MB</td>
<td style="text-align: right;">-3.89</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Short_R</td>
<td style="text-align: right;">-4.26</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP</td>
<td style="text-align: right;">-5.64</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPI</td>
<td style="text-align: right;">-3.87</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.02</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="table-3-adf-test-of-first-difference" class="level6">
<h6 class="anchored" data-anchor-id="table-3-adf-test-of-first-difference">Table 3: ADF test of First Difference</h6>
</section>
</section>
<section id="methodology" class="level2">
<h2 class="anchored" data-anchor-id="methodology"><strong>Methodology</strong></h2>
<p>The <strong>Structural Form (SF) model</strong> of Structural VARs is:</p>
<span class="math display">\[\begin{align}
B_{0} Y_{t} =b_{0}  + \sum_{i=0}^{p} (B_{i}Y_{t-i} )+u_{t}
\end{align}\]</span>
<span class="math display">\[\begin{align}
u_{t}|Y_{t-1} \sim iid(0_{N},I_{N}  )
\end{align}\]</span>
<p><span class="math inline">\(Y_{t}\)</span> is <span class="math inline">\(N \times 1\)</span> matrix of endogenous variable, <span class="math inline">\(B_{0}\)</span> is <span class="math inline">\(N \times N\)</span> matrix of contemporaneous relationships, <span class="math inline">\(u_{t}\)</span> is a <span class="math inline">\(N \times 1\)</span> vector of conditionally on<span class="math inline">\(Y_{t-1}\)</span>orthogonal or independent structural shocks.</p>
<p>The <strong>Reduced Form (RF)</strong> representation is:</p>
<span class="math display">\[\begin{align}
Y_{t} =\mu_{0}  + \sum_{i=0}^{p} (A_{i}Y_{t-i} )+\epsilon_{t}
\end{align}\]</span>
<span class="math display">\[\begin{align}
\epsilon_{t}|Y_{t-1} \sim iid(0_{N},\Sigma )
\end{align}\]</span>
<section id="sign-restriction-identification" class="level3">
<h3 class="anchored" data-anchor-id="sign-restriction-identification"><strong>Sign Restriction Identification</strong></h3>
<p>For the model in this research report, <span class="math inline">\(Y_{t}\)</span> contains 5 variables as:</p>
<p><span class="math display">\[
Y_{t}=\begin{pmatrix}ERA_{t} \\MB_{t} \\{ShortR}_{t} \\GDP_{t} \\CPI_{t}\end{pmatrix}
\]</span></p>
<p>Following the arguments developed in <span class="citation" data-cites="scholl2008a">Scholl and Uhlig (<a href="#ref-scholl2008a" role="doc-biblioref">2008</a>)</span> , that restrictions should be concerning on the shape but not the size of the exchange rate response,thus sign restriction should be imposed. Adapting the methodology specified in <span class="citation" data-cites="kim2018">Kim and Lim (<a href="#ref-kim2018" role="doc-biblioref">2018</a>)</span>, the following sign restrictions are imposed on the impulse response to identify the Monetary policy shock.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Sign Restrictions</caption>
<thead>
<tr class="header">
<th style="text-align: left;">variable</th>
<th style="text-align: left;">res</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ERA</td>
<td style="text-align: left;">unrestricted</td>
</tr>
<tr class="even">
<td style="text-align: left;">MB</td>
<td style="text-align: left;">- negative</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Short_R</td>
<td style="text-align: left;">+ positive</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP</td>
<td style="text-align: left;">unrestricted</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CPI</td>
<td style="text-align: left;">- negative</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="estimation-framework" class="level2">
<h2 class="anchored" data-anchor-id="estimation-framework">Estimation Framework</h2>
<section id="model-specification" class="level3">
<h3 class="anchored" data-anchor-id="model-specification"><strong>Model specification</strong></h3>
<p>The <strong>matrix representation</strong> is:</p>
<span class="math display">\[\begin{align}
Y = XA+E
\end{align}\]</span>
<span class="math display">\[\begin{align}
E|X\sim MN_{T\times N} (0_{T\times N} ,\Sigma ,I_{T})
\end{align}\]</span>
<p><span class="math display">\[
Y =\begin{bmatrix}
                        y_{1'}  \\y_{2'}  \\. \\. \\. \\y_{T'} \end{bmatrix}
A =\begin{bmatrix}\mu_{0'} \\A_{1'} \\.\\.\\.\\A_{p'} \end{bmatrix}
x_{t}  =\begin{bmatrix}\ 1 \\y_{t-1} \\.\\.\\.\\y_{t-p} \end{bmatrix}
X  =\begin{bmatrix}\ x_{1'}  \\x_{2'} \\.\\.\\.\\x_{T'} \end{bmatrix}
E  =\begin{bmatrix}\ \epsilon _{1'}  \\\epsilon _{2'} \\.\\.\\.\\\epsilon _{T'} \end{bmatrix}
\]</span></p>
<p>The <strong>covariance matrix</strong> of <span class="math inline">\(\epsilon_{t}\)</span> can be written as:</p>
<span class="math display">\[\begin{align}
\Sigma  = B_{0} ^{-1} B_{0} ^{-1'}
\end{align}\]</span>
<p>The <strong>Likelihood function</strong> would be:</p>
<p><span class="math display">\[
L(A,\Sigma |Y,X) \propto det(\Sigma)^{-T/2}\exp\left \{{-\frac{1}{2}tr[\Sigma ^{-1}(Y-XA)'(Y-XA)]}   \right \}   
\]</span></p>
<p>The <strong>Maximum Likelihood Estimation</strong> is:</p>
<p><span class="math display">\[
\hat{A} =  (X'X)^{-1}(X'Y)
\]</span></p>
<p><span class="math display">\[
\hat{\Sigma } =  \frac{1}{T} (Y-X\hat{A} )'(Y-X\hat{A} )
\]</span></p>
<p>The <strong>Likelihood function</strong> can be written as a Normal-Inverse Wishart Distribution:</p>
<p><span class="math display">\[
L(A,\Sigma |Y,X) = NIW_{K\times N} (\hat{A},(X'X)^{-1},(Y-X\hat{A} )'(Y-X\hat{A} ),T-N-K-1)
\]</span></p>
<p>The Natural-Conjugate Prior for the SVARs model is also considered as a <strong>Minnesota prior</strong>. The Natural-Conjugate Prior Distribution is:</p>
<p><span class="math display">\[
P(A,\Sigma) = P(A|\Sigma) p(\Sigma)
\]</span></p>
<p><span class="math display">\[
\\
A|\Sigma \sim MN_{K\times N} (\underline{A}, \Sigma,\underline{V})
\]</span></p>
<p><span class="math display">\[
\\
\Sigma\sim IW_{N}( \underline{S},  \underline{v})
\]</span></p>
<p><strong>Minnesota prior</strong> has two main properties:</p>
<p>1.Macroeconomic variables are unit-root non-stationary and are well-characterised by a multivariate random walk process. Thus the prior mean of A is:</p>
<p><span class="math display">\[
\underline{A} = \left [ \mathbf{0}_{N\times1 }\;\; \;I_{N} \;\; \;\mathbf{0}_{N\times(p-1)N } \right ]'
\]</span></p>
<p>2.The Prior Shrinkage is the dispersion of prior distribution around prior mean <span class="math inline">\(\underline{A}\)</span> is determined by the diagonal element <span class="math inline">\(\underline{V}\)</span> , thus the prior covariance matrix and diagonal element are:</p>
<p><span class="math display">\[Var[vec(A)] = \Sigma  \otimes V\]</span> <span class="math display">\[\underline{V}=diag\left ( \left [ k_{2} \; \; \;k_{1}(\mathbf{p} ^{-2}\otimes \imath '_{N}    \right ]  \right )   \]</span></p>
<p>for <span class="math inline">\(\mathbf{p}=[1,2...p]\)</span> and <span class="math inline">\(\imath =rep(1,N)\)</span></p>
</section>
</section>
<section id="baseline-model" class="level2">
<h2 class="anchored" data-anchor-id="baseline-model"><strong>Baseline Model</strong></h2>
<p>Overall, the <strong>Full Conditional Posterior</strong> can be derived as:</p>
<p><span class="math display">\[
p(A,\Sigma |Y,X) \propto  L(A,\Sigma|Y,X)p(A,\Sigma)
\]</span></p>
<p><span class="math display">\[p(A,\Sigma |Y,X) = p(A|Y,X,\Sigma)p(\Sigma|Y,X)\]</span></p>
<p><span class="math display">\[
p(A|Y,X,\Sigma) =  MN_{K\times N } (\overline{A}, \Sigma,\overline{V})
\]</span></p>
<p><span class="math display">\[
p(\Sigma|Y,X) = IW_{N}(\overline{S},\overline{v})
\]</span></p>
<p>The main parameters are:</p>
<p><span class="math display">\[
\left\{\begin{matrix}\overline{V}=(X'X+\underline{V}^{-1} )^{-1} \\\overline{A}=\overline{V}(X'Y+\underline{V}^{-1} \underline{A}) \\\overline{v}=T+\underline{v} \\\overline{S}=\underline{S}+Y'Y+\underline{A}'\underline{V}^{-1}\underline{A}-\overline{A}'\overline{V}^{-1}\overline{A}\end{matrix}\right.
\]</span></p>
<section id="estimation-procedure" class="level3">
<h3 class="anchored" data-anchor-id="estimation-procedure"><strong>Estimation Procedure</strong></h3>
<p><strong>Step1:</strong> Simulate 300 samples of Y with 2 columns indicating 2 policy effect(N=2) using bi-variate Gaussian random walk processes, that is p=1. Thus, K = 1+Np =3. Using sample Y can also generate sample X.</p>
<p><strong>Step2:</strong> Use the sample Y and X to compute the estimated posterior parameters <span class="math inline">\(\overline{V},\overline{A},\overline{v},\overline{S}\)</span> as shown above.</p>
<p><strong>Step3:</strong> Draw samples of sample <span class="math inline">\(\Sigma ^{(s)}\)</span> and <span class="math inline">\(A ^{(s)}\)</span> using posterior parameters observed in step 2 and iterations S = 1000.</p>
<p>At each iteration <span class="math inline">\(s\)</span>:</p>
<ol type="1">
<li><p>Draw <span class="math inline">\(\Sigma^{(s)}\)</span> from <span class="math inline">\(\mathcal{IW}_{N}(\overline{S}, \overline{v})\)</span>, and take <span class="math inline">\(\Sigma^{(s)}\)</span> as known</p></li>
<li><p>Draw <span class="math inline">\(A^{(s)}\)</span> from <span class="math inline">\(\mathcal{MN}_{K\times N}(\overline{A}, \Sigma,\overline{V} )\)</span> by insert <span class="math inline">\(\Sigma^{(s)}\)</span></p></li>
</ol>
<p>Output is the sample draws from the joint posterior distribution <span class="math inline">\(\left\{ {A^{(s)}, \Sigma^{(s)}} \right\}^{S}_{s=1}\)</span>.</p>
<p><strong>Step4</strong>: Compute the initial value of SF parameters using the covariance matrix which implies: <span class="math inline">\(\tilde{B_{0}} = chol(\Sigma^{(s)-1})\)</span> and <span class="math inline">\(\tilde{B_{+}} = \tilde{B_{0}} A^{(s)}\)</span></p>
<p><strong>Step5</strong>: Define the restriction matrix R, which is a diagonal matrix that identify the restrictions.</p>
<p>Draw an independent standard normal <span class="math inline">\(N\times N\)</span> matrix Z and let Z = QR be the QR decomposition of Z with the diagonal of R normalized to be positive, return sample <span class="math inline">\(Q^{(D)}\)</span> Sample Q from Harr distribution.</p>
<p><strong>Step6</strong>:Use matrix <span class="math inline">\(Q^{(D)}\)</span> to compute parameters <span class="math inline">\(B_{0} = Q\tilde{B_{0}}\)</span> and <span class="math inline">\(B_{+} = Q\tilde{B_{+}}\)</span> and the corresponding impulse responses <span class="math inline">\(\Theta\)</span> that subject to sign restrictions.</p>
<p>To check that <span class="math inline">\(Rf(B_{+},B_{0})e_{n}&gt;0_{R\times 1}\)</span> for n = 1,…,N.</p>
<p>If these parameters do not satisfy the sign restrictions defined in step5, then return to step5.</p>
<p><strong>Step7:</strong> After iterations, if these parameters do satisfy the sign restrictions, return the parameters <span class="math inline">\((B_{+} ,B_{0} )\)</span></p>
</section>
<section id="estimation-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="estimation-algorithm"><strong>Estimation Algorithm</strong></h3>
<p>Function below is the <code>posterior.draws</code> for step 3 to 4:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw samples of A and sigma</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>posterior.draws <span class="ot">=</span> <span class="cf">function</span>(S, posterior_pram){</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  A.bar  <span class="ot">&lt;-</span> posterior_pram<span class="sc">$</span>A_bar</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  V.bar  <span class="ot">&lt;-</span> posterior_pram<span class="sc">$</span>V_bar</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  S.bar  <span class="ot">&lt;-</span> posterior_pram<span class="sc">$</span>S_bar</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  nu.bar <span class="ot">&lt;-</span> posterior_pram<span class="sc">$</span>nu_bar</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  B0.tilde <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  B1.tilde <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,K,S))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  L        <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar)) </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior   <span class="ot">&lt;-</span> <span class="fu">rWishart</span>(S, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span><span class="fu">solve</span>(S.bar))  </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior   <span class="ot">&lt;-</span> <span class="fu">apply</span>(Sigma.posterior,<span class="dv">3</span>,solve)            </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior   <span class="ot">&lt;-</span> <span class="fu">array</span>(Sigma.posterior,<span class="fu">c</span>(N,N,S))   </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  A.posterior       <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),S))),<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),S))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute the initial value of SF parameters</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    cholSigma.s      <span class="ot">&lt;-</span> <span class="fu">chol</span>(Sigma.posterior[,,s])</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    B0.tilde[,,s] <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(cholSigma.s)) </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    A.posterior[,,s] <span class="ot">&lt;-</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.posterior[,,s]<span class="sc">%*%</span>cholSigma.s </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    B1.tilde[,,s]  <span class="ot">&lt;-</span> B0.tilde[,,s]<span class="sc">%*%</span><span class="fu">t</span>(A.posterior[,,s])</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a> <span class="co"># Sample draws from the joint posterior distribution </span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">A.posterior     =</span> A.posterior,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">B0.tilde        =</span> B0.tilde,</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">B1.tilde        =</span> B1.tilde,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">Sigma.posterior =</span> Sigma.posterior))</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After drawing posterior parameters, we impose sign restrictions to identify the model. Use the orthogonal matrix Q, to identity such that <span class="math inline">\(B_{0} = Q\tilde{B_{0}}\)</span> and <span class="math inline">\(B_{+} = Q\tilde{B_{+}}\)</span> satisfy the sign restrictions, as the the algorithm implemented in <span class="citation" data-cites="fry2011">Fry and Pagan (<a href="#ref-fry2011" role="doc-biblioref">2011</a>)</span>.</p>
<p>Function below is the <code>ImposeSignRestriction</code> for step 5 to 7:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ImposeSignRestriction <span class="ot">&lt;-</span> <span class="cf">function</span> (restrictions,N,p,S,posterior.draws){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>B0.draws      <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>B1.draws      <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,(<span class="dv">1</span><span class="sc">+</span>N<span class="sc">*</span>p),S))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>B0.tilde <span class="ot">=</span> posterior.draws<span class="sc">$</span>B0.tilde</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>B1.tilde <span class="ot">=</span> posterior.draws<span class="sc">$</span>B1.tilde</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>R1 <span class="ot">=</span> restrictions</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>i.vec <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> S</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  B0.t    <span class="ot">=</span> B0.tilde[,,s]</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  B1.t    <span class="ot">=</span> B1.tilde[,,s]</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  sign.restrictions.do.not.hold <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (sign.restrictions.do.not.hold){</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  Z           <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(N<span class="sc">*</span>N),N,N)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  QR          <span class="ot">=</span> <span class="fu">qr</span>(Z, <span class="at">tol =</span> <span class="fl">1e-10</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  Q           <span class="ot">=</span> <span class="fu">qr.Q</span>(QR,<span class="at">complete=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  R           <span class="ot">=</span> <span class="fu">qr.R</span>(QR,<span class="at">complete=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  Q           <span class="ot">=</span> <span class="fu">t</span>(Q <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="fu">sign</span>(<span class="fu">diag</span>(R))))</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  B0          <span class="ot">=</span> Q<span class="sc">%*%</span>B0.t</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  B1          <span class="ot">=</span> Q<span class="sc">%*%</span>B1.t</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  B0.inv      <span class="ot">=</span> <span class="fu">solve</span>(B0)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  sign.restrictions.do.not.hold <span class="ot">=</span> <span class="sc">!</span><span class="fu">prod</span>(R1 <span class="sc">%*%</span> B0 <span class="sc">%*%</span> <span class="fu">diag</span>(N)[,<span class="dv">1</span>]  <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  i.vec <span class="ot">=</span> <span class="fu">c</span>(i.vec,i) </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  B0.draws[,,s] <span class="ot">=</span> B0</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  B1.draws[,,s] <span class="ot">=</span> B1</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span> (<span class="fu">list</span>(<span class="at">B0.draws =</span> B0.draws,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">B1.draws =</span> B1.draws,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">i =</span> i.vec))</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simulation-result" class="level3">
<h3 class="anchored" data-anchor-id="simulation-result"><strong>Simulation Result</strong></h3>
<p><a href="#table-4-posterior-mean-of-a">Table 4: posterior mean of A</a> show the matrix of A suggesting the baseline model estimation using artificial data of 1 lag and constant term is showing zero posterior mean.</p>
<p><a href="#table-5-posterior-mean-of-sigma">Table 5 posterior mean of Sigma</a> shows that covariance matrices <span class="math inline">\(\Sigma\)</span> are close to an identity matrix.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>posterior mean of A</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">constant term</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">lag-1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lag-2</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.97</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="table-4-posterior-mean-of-a" class="level6">
<h6 class="anchored" data-anchor-id="table-4-posterior-mean-of-a">Table 4: posterior mean of A</h6>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>posterior mean of Sigma</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">y1</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">-0.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">y2</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.94</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="table-5-posterior-mean-of-sigma" class="level6">
<h6 class="anchored" data-anchor-id="table-5-posterior-mean-of-sigma">Table 5 posterior mean of Sigma</h6>
<p>The simulated result of <span class="math inline">\(B_{0}\)</span> and <span class="math inline">\(B_{+}\)</span> are shown in the table below:</p>
<p>As the restrictions is positive diagonal, the result of <span class="math inline">\(B_{0}\)</span> satisfy the sign restrictions with a positive diagonal as shown in <a href="#table-6-posterior-mean-of-b0">Table 6: posterior mean of B0</a>.</p>
<p>The lag 1 <span class="math inline">\(B_{1}\)</span> are shown in <a href="#table-7-posterior-mean-of-b1">Table 7: posterior mean of B1</a>, with similar result in y1 and y2 as <span class="math inline">\(B_{0}\)</span> , also with a positive diagonal, indicating it also satisfy the sign restrictions.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>posterior mean of B0</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">y1</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">y2</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">0.07</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="table-6-posterior-mean-of-b0" class="level6">
<h6 class="anchored" data-anchor-id="table-6-posterior-mean-of-b0">Table 6: posterior mean of B0</h6>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>posterior mean of B1</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">constant</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">y1</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.66</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y2</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.07</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="table-7-posterior-mean-of-b1" class="level6">
<h6 class="anchored" data-anchor-id="table-7-posterior-mean-of-b1">Table 7: posterior mean of B1</h6>
</section>
</section>
</section>
<section id="extension-model-with-gamma-distribution" class="level2">
<h2 class="anchored" data-anchor-id="extension-model-with-gamma-distribution"><strong>Extension Model With Gamma Distribution</strong></h2>
<p>Considering the extension on the <span class="math inline">\(\Sigma\)</span> , assume the hyper parameter <span class="math inline">\(\underline{S}\)</span> of the prior distribution for <span class="math inline">\(\Sigma\)</span> is now adjust as <span class="math inline">\(\lambda I_{N}\)</span>, where the parameter <span class="math inline">\(\lambda\)</span> following gamma prior distribution, using a hierarchical model.</p>
<p><span class="math display">\[
p(A,\Sigma |Y,X) \propto  L(A,\Sigma|Y,X)p(A,\Sigma)
\]</span></p>
<p><span class="math display">\[p(A,\Sigma |Y,X) = p(A|Y,X,\Sigma)p(\Sigma|Y,X,\lambda)\]</span></p>
<p><span class="math display">\[
\Sigma |\lambda \sim IW(\lambda I_{N}, \underline{\upsilon } )
\]</span></p>
<p><span class="math display">\[\lambda \sim \mathcal{Gamma}(\underline{s},\underline{a}  )\]</span></p>
<p>The <strong>Full Conditional Posterior</strong> of <span class="math inline">\(\lambda\)</span> given <span class="math inline">\(\Sigma\)</span> can be derived as:</p>
<p><span class="math display">\[
\begin{aligned}
p(\lambda |Y,X,\Sigma )
&amp;\propto L(A,\Sigma|Y,X)p(\Sigma,A, \lambda)\\
&amp;\propto L(A,\Sigma|Y,X)p(\Sigma|A, \lambda)p(A)p(\lambda)\\
&amp;\propto p(\Sigma|A,\lambda)p(\lambda) \\
&amp;\propto det(\lambda I_{N})^{\frac{\underline{\upsilon} }{2}} \exp \left \{ -\frac{1}{2}tr\left [ \Sigma ^{-1}\lambda I_{N}\right]\right \}\lambda^{\underline{a}-1}e^{-\frac{\lambda}{\underline{s}} }  \\
&amp;\propto (\lambda I_{N})^{\frac{\underline{\upsilon}N }{2}+\underline{a}-1} \exp \left \{ -\frac{1}{2}tr\left [ \Sigma ^{-1}\lambda I_{N}\right]-\frac{\lambda}{\underline{s}}\right \} \\
&amp;\propto (\lambda I_{N})^{\frac{\underline{\upsilon}N }{2}+\underline{a}-1} \exp \left \{ -\lambda(\frac{1}{2}tr\left [ \Sigma ^{-1} \right]+\frac{1}{\underline{s}})\right \}
\end{aligned}
\]</span></p>
<p>As we can show the kernel follows Gamma Distribution as the kernel Gamma distribution is:<span class="math display">\[p(x|s,a) \propto x^{a-1}exp \left\{\frac{-(x)}{s} \right\}\]</span></p>
<p>Hence, the full-conditional posterior distribution of <span class="math inline">\(\lambda\)</span> follows a Gamma Distribution.</p>
<p><span class="math display">\[
\lambda|Y,X,\Sigma \sim \mathcal{Gamma}(\overline{a},\overline{s})
\]</span></p>
<p>The main parameters are:</p>
<p><span class="math display">\[
\left\{\begin{matrix} \overline{s}=[\frac{1}{2}tr\left [ \Sigma ^{-1} \right]+\frac{1}{\underline{s}}] \\\overline{a}=\frac{\underline{\upsilon}N }{2}+\underline{a}\end{matrix}\right.
\]</span></p>
<section id="gibb-sampler-using-extension-models" class="level4">
<h4 class="anchored" data-anchor-id="gibb-sampler-using-extension-models">Gibb Sampler using extension models</h4>
<p>Draw samples of sample <span class="math inline">\(\Sigma ^{(s)}\)</span> , <span class="math inline">\(\lambda ^{(s)}\)</span> and <span class="math inline">\(A ^{(s)}\)</span> using posterior parameters.</p>
<p>Initialized <span class="math inline">\(\lambda ^{(s)}\)</span> as <span class="math inline">\(\lambda ^{(0)}\)</span> = 2</p>
<p>At each iteration <span class="math inline">\(s\)</span>:</p>
<ol type="1">
<li><p>Draw <span class="math inline">\(\Sigma^{(s)}\)</span> from <span class="math inline">\(\mathcal{IW}_{N}(\overline{S}, \overline{v})\)</span>, and using the initialized <span class="math inline">\(\lambda ^{(0)}\)</span></p></li>
<li><p>Draw <span class="math inline">\(\lambda ^{(s)}\)</span> from <span class="math inline">\(\lambda ^{(s)}\)</span>, by insert <span class="math inline">\(\Sigma^{(s)}\)</span></p></li>
<li><p>Draw <span class="math inline">\(A^{(s)}\)</span> from <span class="math inline">\(\mathcal{MN}_{K\times N}(\overline{A}, \Sigma,\overline{V} )\)</span> by insert <span class="math inline">\(\Sigma^{(s)}\)</span></p></li>
</ol>
<p>Repeat 1 and 2 <span class="math inline">\(S_{1}+S_{2}\)</span>times.</p>
<p>Discard the first <span class="math inline">\(S_{1}\)</span> draws that allows the algorithm to converge to the stationary posterior distribution.</p>
<p>Output is the sample draws from the joint posterior distribution <span class="math inline">\(\left\{ {A^{(s)}, \Sigma^{(s)}} ,\lambda ^{(s)}\right\}^{S_{1}+S_{2}}_{s=S_{1}+1}\)</span>.</p>
</section>
<section id="estimation-algorithm-1" class="level3">
<h3 class="anchored" data-anchor-id="estimation-algorithm-1"><strong>Estimation Algorithm</strong></h3>
<p>Function below is the <code>posterior.draws.exten</code> for Gibb Sampler:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#posterior parameters</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  posterior.draws.exten <span class="ot">=</span> <span class="cf">function</span>(S1,S2,X,Y,A,V,nu){</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    i_N <span class="ot">&lt;-</span> <span class="fu">diag</span>(N)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#posterior</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    V_bar.inv <span class="ot">&lt;-</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X <span class="sc">+</span> <span class="fu">solve</span>(V)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    V_bar <span class="ot">&lt;-</span> <span class="fu">solve</span>(V_bar.inv)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    A_bar <span class="ot">&lt;-</span> V_bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">solve</span>(V)<span class="sc">%*%</span>A)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    nu_bar <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Y) <span class="sc">+</span> nu</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    S_total <span class="ot">=</span> S1<span class="sc">+</span>S2</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    A.posterior <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(<span class="fu">dim</span>(A_bar),S_total))),<span class="fu">c</span>(<span class="fu">dim</span>(A_bar),S_total))</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    B0.tilde <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S_total))</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    B1.tilde <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,K,S_total))</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    L        <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">chol</span>(V_bar)) </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior <span class="ot">&lt;-</span><span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S_total))</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    lambda.posterior  <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, S_total, <span class="dv">1</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    lambda.posterior[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S_total){</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    S_bar_ext   <span class="ot">&lt;-</span> lambda.posterior[s]<span class="sc">*</span>i_N <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span>Y<span class="sc">+</span> <span class="fu">t</span>(A)<span class="sc">%*%</span><span class="fu">solve</span>(V)<span class="sc">%*%</span>A<span class="sc">-</span> <span class="fu">t</span>(A_bar)<span class="sc">%*%</span>V_bar.inv<span class="sc">%*%</span>A_bar</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior_d      <span class="ot">&lt;-</span> <span class="fu">rWishart</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">df=</span>nu_bar, <span class="at">Sigma=</span><span class="fu">solve</span>(S_bar_ext))  </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior_draw   <span class="ot">&lt;-</span> <span class="fu">apply</span>(Sigma.posterior_d ,<span class="dv">3</span>,solve)            </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior[,,s]   <span class="ot">&lt;-</span> Sigma.posterior_draw </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    s.posterior <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fl">0.5</span><span class="sc">*</span><span class="fu">sum</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(Sigma.posterior[,,s])))<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>s_prior)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    a.posterior <span class="ot">&lt;-</span> a_prior<span class="sc">+</span>(nu_bar<span class="sc">*</span>N)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s<span class="sc">!=</span>S_total){</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>      lambda.posterior[s<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">shape =</span> s.posterior,  <span class="at">scale =</span> a.posterior)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>      cholSigma.s      <span class="ot">&lt;-</span> <span class="fu">chol</span>(Sigma.posterior[,,s])</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>      B0.tilde[,,s] <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(cholSigma.s)) </span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>      A.posterior[,,s] <span class="ot">&lt;-</span> A_bar <span class="sc">+</span> L<span class="sc">%*%</span>A.posterior[,,s]<span class="sc">%*%</span>cholSigma.s </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>      B1.tilde[,,s]  <span class="ot">&lt;-</span> B0.tilde[,,s]<span class="sc">%*%</span><span class="fu">t</span>(A.posterior[,,s])</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">A.posterior     =</span> A.posterior[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>S_total],</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">B0.tilde        =</span> B0.tilde[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>S_total],</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>                <span class="at">B1.tilde        =</span> B1.tilde[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>S_total],</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>                <span class="at">Sigma.posterior =</span> Sigma.posterior[,,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>S_total]</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>                  ))</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simulation-result-1" class="level3">
<h3 class="anchored" data-anchor-id="simulation-result-1"><strong>Simulation Result</strong></h3>
<p><a href="#table-8-posterior-mean-of-a-of-extension-model">Table 8: posterior mean of A of extension model</a> shows the posterior mean of matrix of A following the extension model, the constant term is also showing zero posterior mean. <a href="#table-9-posterior-mean-of-sigma-of-extension-model">Table 9: posterior mean of Sigma of extension model</a> shows that covariance matrices <span class="math inline">\(\Sigma\)</span> of the extension model also close to an identity matrix.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>posterior mean of A</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">constant term</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.19</td>
</tr>
<tr class="even">
<td style="text-align: left;">lag-1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lag-2</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.97</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="table-8-posterior-mean-of-a-of-extension-model" class="level6">
<h6 class="anchored" data-anchor-id="table-8-posterior-mean-of-a-of-extension-model">Table 8: posterior mean of A of extension model</h6>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>posterior mean of Sigma</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">y1</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">-0.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">y2</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">1.27</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="table-9-posterior-mean-of-sigma-of-extension-model" class="level6">
<h6 class="anchored" data-anchor-id="table-9-posterior-mean-of-sigma-of-extension-model">Table 9: posterior mean of Sigma of extension model</h6>
<p>The simulated result of <span class="math inline">\(B_{0}\)</span> and <span class="math inline">\(B_{+}\)</span> from the extension model also has conclusion with the baseline model, indicating the sign restrictions imposed are satisfied. With a positive diagonal shown in <a href="#table-10-posterior-mean-of-b0-of-extension-model">Table 10: posterior mean of B0 of extension model</a> in the posterior mean of <span class="math inline">\(B_{0}\)</span> . Also in <a href="#table-11-posterior-mean-of-b0-of-extension-model">Table 11: posterior mean of B0 of extension model</a> <span class="math inline">\(B_{1}\)</span> shows a positive diagonal for y1 and y2, similar value as <span class="math inline">\(B_{0}\)</span> .</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>posterior mean of B0</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">y1</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">y2</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.05</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="table-10-posterior-mean-of-b0-of-extension-model" class="level6">
<h6 class="anchored" data-anchor-id="table-10-posterior-mean-of-b0-of-extension-model">Table 10: posterior mean of B0 of extension model</h6>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>posterior mean of B1</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">constant</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">-0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">y1</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.59</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y2</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.05</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="table-11-posterior-mean-of-b0-of-extension-model" class="level6">
<h6 class="anchored" data-anchor-id="table-11-posterior-mean-of-b0-of-extension-model">Table 11: posterior mean of B0 of extension model</h6>
</section>
</section>
</section>
<section id="empirical-estimation-results" class="level2">
<h2 class="anchored" data-anchor-id="empirical-estimation-results">Empirical Estimation Results</h2>
</section>
<section id="baseline-model-1" class="level2">
<h2 class="anchored" data-anchor-id="baseline-model-1"><strong>Baseline Model</strong></h2>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>posterior mean of A</caption>
<thead>
<tr class="header">
<th style="text-align: right;">ERA</th>
<th style="text-align: right;">MB</th>
<th style="text-align: right;">Short_R</th>
<th style="text-align: right;">GDP</th>
<th style="text-align: right;">CPI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0032</td>
<td style="text-align: right;">0.0708</td>
<td style="text-align: right;">0.5572</td>
<td style="text-align: right;">0.0275</td>
<td style="text-align: right;">0.0016</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.9978</td>
<td style="text-align: right;">-0.0010</td>
<td style="text-align: right;">-0.0082</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0001</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.9969</td>
<td style="text-align: right;">-0.0236</td>
<td style="text-align: right;">-0.0016</td>
<td style="text-align: right;">0.0005</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.0010</td>
<td style="text-align: right;">-0.0041</td>
<td style="text-align: right;">1.0277</td>
<td style="text-align: right;">-0.0004</td>
<td style="text-align: right;">0.0010</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0001</td>
<td style="text-align: right;">-0.0004</td>
<td style="text-align: right;">-0.0003</td>
<td style="text-align: right;">0.9997</td>
<td style="text-align: right;">0.0001</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.0004</td>
<td style="text-align: right;">-0.0006</td>
<td style="text-align: right;">-0.0129</td>
<td style="text-align: right;">-0.0005</td>
<td style="text-align: right;">1.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.0006</td>
<td style="text-align: right;">-0.0003</td>
<td style="text-align: right;">-0.0042</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0001</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0008</td>
<td style="text-align: right;">-0.0049</td>
<td style="text-align: right;">-0.0004</td>
<td style="text-align: right;">0.0001</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.0002</td>
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">-0.0404</td>
<td style="text-align: right;">-0.0003</td>
<td style="text-align: right;">-0.0003</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0008</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0045</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.0003</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0032</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0004</td>
<td style="text-align: right;">-0.0015</td>
<td style="text-align: right;">-0.0002</td>
<td style="text-align: right;">0.0001</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">0.0009</td>
<td style="text-align: right;">-0.0346</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0003</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0006</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0019</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0022</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0002</td>
<td style="text-align: right;">-0.0013</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">-0.0224</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0002</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0010</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>posterior mean of Sigma</caption>
<thead>
<tr class="header">
<th style="text-align: right;">ERA</th>
<th style="text-align: right;">MB</th>
<th style="text-align: right;">Short_R</th>
<th style="text-align: right;">GDP</th>
<th style="text-align: right;">CPI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0018</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0043</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0007</td>
<td style="text-align: right;">-0.0043</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0043</td>
<td style="text-align: right;">-0.0043</td>
<td style="text-align: right;">0.2028</td>
<td style="text-align: right;">3e-04</td>
<td style="text-align: right;">8e-04</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0003</td>
<td style="text-align: right;">1e-04</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0008</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="extension-model-with-gamma-distribution-1" class="level2">
<h2 class="anchored" data-anchor-id="extension-model-with-gamma-distribution-1"><strong>Extension Model With Gamma Distribution</strong></h2>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>posterior mean of A</caption>
<thead>
<tr class="header">
<th style="text-align: right;">ERA</th>
<th style="text-align: right;">MB</th>
<th style="text-align: right;">Short_R</th>
<th style="text-align: right;">GDP</th>
<th style="text-align: right;">CPI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0032</td>
<td style="text-align: right;">0.0708</td>
<td style="text-align: right;">0.5572</td>
<td style="text-align: right;">0.0275</td>
<td style="text-align: right;">0.0016</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.9978</td>
<td style="text-align: right;">-0.0010</td>
<td style="text-align: right;">-0.0082</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0001</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.9969</td>
<td style="text-align: right;">-0.0236</td>
<td style="text-align: right;">-0.0016</td>
<td style="text-align: right;">0.0005</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.0010</td>
<td style="text-align: right;">-0.0041</td>
<td style="text-align: right;">1.0277</td>
<td style="text-align: right;">-0.0004</td>
<td style="text-align: right;">0.0010</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0001</td>
<td style="text-align: right;">-0.0004</td>
<td style="text-align: right;">-0.0003</td>
<td style="text-align: right;">0.9997</td>
<td style="text-align: right;">0.0001</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.0004</td>
<td style="text-align: right;">-0.0006</td>
<td style="text-align: right;">-0.0129</td>
<td style="text-align: right;">-0.0005</td>
<td style="text-align: right;">1.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.0006</td>
<td style="text-align: right;">-0.0003</td>
<td style="text-align: right;">-0.0042</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0001</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0008</td>
<td style="text-align: right;">-0.0049</td>
<td style="text-align: right;">-0.0004</td>
<td style="text-align: right;">0.0001</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.0002</td>
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">-0.0404</td>
<td style="text-align: right;">-0.0003</td>
<td style="text-align: right;">-0.0003</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0008</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0045</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.0003</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0032</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0004</td>
<td style="text-align: right;">-0.0015</td>
<td style="text-align: right;">-0.0002</td>
<td style="text-align: right;">0.0001</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">0.0009</td>
<td style="text-align: right;">-0.0346</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0003</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0006</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0019</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0022</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0002</td>
<td style="text-align: right;">-0.0013</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">-0.0224</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">-0.0002</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">-0.0010</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>posterior mean of Sigma</caption>
<thead>
<tr class="header">
<th style="text-align: right;">ERA</th>
<th style="text-align: right;">MB</th>
<th style="text-align: right;">Short_R</th>
<th style="text-align: right;">GDP</th>
<th style="text-align: right;">CPI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0018</td>
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0043</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.0001</td>
<td style="text-align: right;">0.0007</td>
<td style="text-align: right;">-0.0043</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0043</td>
<td style="text-align: right;">-0.0043</td>
<td style="text-align: right;">0.2028</td>
<td style="text-align: right;">3e-04</td>
<td style="text-align: right;">8e-04</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0003</td>
<td style="text-align: right;">1e-04</td>
<td style="text-align: right;">0e+00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0008</td>
<td style="text-align: right;">0e+00</td>
<td style="text-align: right;">0e+00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="references" class="level2">




</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-dornbusch1976" class="csl-entry" role="listitem">
Dornbusch, Rudiger. 1976. <span>“Expectations and Exchange Rate Dynamics.”</span> <em>Journal of Political Economy</em> 84 (6): 1161–76. <a href="https://doi.org/10.1086/260506">https://doi.org/10.1086/260506</a>.
</div>
<div id="ref-eichenbaum1995" class="csl-entry" role="listitem">
Eichenbaum, M., and C. L. Evans. 1995. <span>“Some Empirical Evidence on the Effects of Shocks to Monetary Policy on Exchange Rates.”</span> <em>The Quarterly Journal of Economics</em> 110 (4): 975–1009. <a href="https://doi.org/10.2307/2946646">https://doi.org/10.2307/2946646</a>.
</div>
<div id="ref-fry2011" class="csl-entry" role="listitem">
Fry, Renée, and Adrian Pagan. 2011. <span>“Sign Restrictions in Structural Vector Autoregressions: A Critical Review.”</span> <em>Journal of Economic Literature</em> 49 (4): 938–60. <a href="https://doi.org/10.1257/jel.49.4.938">https://doi.org/10.1257/jel.49.4.938</a>.
</div>
<div id="ref-kim2018" class="csl-entry" role="listitem">
Kim, Soyoung, and Kuntae Lim. 2018. <span>“Effects of Monetary Policy Shocks on Exchange Rate in Small Open Economies.”</span> <em>Journal of Macroeconomics</em> 56 (June): 324–39. <a href="https://doi.org/10.1016/j.jmacro.2018.04.008">https://doi.org/10.1016/j.jmacro.2018.04.008</a>.
</div>
<div id="ref-scholl2008a" class="csl-entry" role="listitem">
Scholl, Almuth, and Harald Uhlig. 2008. <span>“New Evidence on the Puzzles: Results from Agnostic Identification on Monetary Policy and Exchange Rates.”</span> <em>Journal of International Economics</em> 76 (1): 1–13. <a href="https://doi.org/10.1016/j.jinteco.2008.02.005">https://doi.org/10.1016/j.jinteco.2008.02.005</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>